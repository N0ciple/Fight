#ifndef CAMERA_H
#define CAMERA_H

#include "global.h"

struct Camera {
  int16_t offx=0;
  int8_t offy=0;
  int8_t  pLimx = 16;
  int8_t pLimy = 16; 
};

int posx;
int posy;

const byte PROGMEM MAP_STRUCT[][64] = {
  {8,8,8,8,8,8,8,8,7,6,6,6,6,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,5,5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,8,8,8,8,8,8,4,8,8,8,8,8,8,0,0,13,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,5,5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,8,8,8,8,8,8,4,8,5,5,8,8,5,5,0,13,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,5,5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,8,8,8,8,8,8,4,8,8,0,8,8,8,8,8,13,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,8,8,8,8,8,8,4,8,8,8,8,8,8,8,8,13,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,8,8,8,8,8,8,4,8,5,5,8,8,5,5,8,13,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,5,5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,8,8,8,8,8,8,4,8,0,8,8,8,8,8,8,13,6,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,7,6,6,6,6,6,6,4,8,8,8,8,0,8,8,8,13,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,6,6,6,6,6,6,4,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,4,8,8,8,8,8,4,8,5,5,8,8,0,8,8,13,8,8,10,11,12,8,8,8,8,8,8,8,8,8,8,8,4,8,8,8,8,8,4,8,5,5,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {8,8,8,4,2,8,5,5,8,4,8,8,8,2,8,8,2,8,13,8,8,15,17,19,8,8,8,8,8,8,8,8,8,8,8,4,2,8,5,5,8,4,8,8,8,2,8,8,2,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {9,9,9,4,3,8,8,8,8,4,8,0,8,3,8,8,3,8,13,8,8,16,18,20,8,8,14,14,8,8,8,8,9,9,9,4,3,8,8,8,8,4,8,8,8,3,8,8,3,8,8,8,8,8,8,8,8,8,8,8,8,8,8,},
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,},
};


struct Camera camera;


void drawBackground(){

  for(int i = 0;i<13;i++){
      for(int j = max(0,ceil((camera.offx-8)/8)); j<ceil((camera.offx+WIDTH+8)/8);j++){
        posx = j*8-camera.offx%255;
        posy = i*8-camera.offy-24;
        if(posx<-7){
          posx +=256;
        }
        sprite.drawSelfMasked(posx,i*8-camera.offy-40,TILE,pgm_read_byte(&MAP_STRUCT[i][j]));
      }
    }

}

#endif
